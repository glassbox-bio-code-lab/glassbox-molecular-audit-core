{{- /* yamllint disable rule:comments-indentation */ -}}
apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "molecular-audit-core.fullname" . }}-config
  namespace: {{ .Release.Namespace | quote }}
  labels:
    {{- include "molecular-audit-core.labels" . | nindent 4 }}
data:
  PROJECT_ID: {{ .Values.config.projectId | quote }}
  GBX_RUN_MODE: {{ .Values.config.runMode | quote }}
  PHASE: {{ .Values.config.phase | quote }}
  INPUT_PATH: {{ .Values.config.inputPath | quote }}
  OUTPUT_PATH: {{ .Values.config.outputPath | quote }}
  {{- if .Values.config.runId }}
  # Optional deterministic run_id. The runner writes outputs under OUTPUT_PATH/<run_id>.
  GBX_RUN_ID: {{ .Values.config.runId | quote }}
  {{- end }}
  NOVEL_TARGET_MODE: {{ .Values.config.novelTargetMode | quote }}
  TRIANGULATION_REQUIRED: {{ .Values.config.triangulationRequired | quote }}
  VERDICT_MODE: {{ .Values.config.verdictMode | quote }}
  RUBRIC_PRESET: {{ .Values.config.rubricPreset | quote }}
  FAIL_CLOSED: {{ .Values.config.failClosed | quote }}
  REPRO_PACK_ENABLED: {{ .Values.config.reproPackEnabled | quote }}
  GBX_ENTITLEMENT_URL: {{ .Values.config.entitlementUrl | quote }}
  # Back-compat for older runner images that still check for GBX_ENTITLEMENT_TOKEN.
  # In identity-only mode this is a non-secret placeholder.
  GBX_ENTITLEMENT_TOKEN: {{ .Values.config.entitlementToken | quote }}
  GBX_ENTITLEMENT_AUTH_MODE: {{ .Values.config.entitlementAuthMode | quote }}
  GBX_ENTITLEMENT_AUDIENCE: {{ .Values.config.entitlementAudience | quote }}
  {{- if .Values.config.entitlementPrincipal }}
  GBX_ENTITLEMENT_PRINCIPAL: {{ .Values.config.entitlementPrincipal | quote }}
  {{- end }}
  {{- if .Values.config.entitlementBearerToken }}
  GBX_ENTITLEMENT_BEARER_TOKEN: {{ .Values.config.entitlementBearerToken | quote }}
  {{- end }}
  TN_DISABLE_EXTERNAL_DATA: {{ .Values.config.TN_DISABLE_EXTERNAL_DATA | quote }}
  TN_ENABLE_UQ: {{ .Values.config.TN_ENABLE_UQ | quote }}
  TN_ENABLE_OT_FEATURES: {{ .Values.config.TN_ENABLE_OT_FEATURES | quote }}
  GBX_STANDARD_MODE_QUIET: {{ .Values.config.standardModeQuiet | quote }}
